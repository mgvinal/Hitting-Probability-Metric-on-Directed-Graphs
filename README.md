# Hitting-Probability-Metric-on-Directed-Graphs
This code is the Python adaptation of the MATLAB code found in the paper ["A Metric on Directed Graphs and Markov Chains Based on Hitting Probabilities,"](https://marzuola.web.unc.edu/wp-content/uploads/sites/16865/2020/06/A_metric_on_the_state_space_of_Markov_chains_based_on_hitting_times.pdf) by Boyd, Fraiman, Marzuola, Mucha, Osting, and Weare. In the past, shortest path and effective resistance graph metrics have been naively applied to directed graphs in the same way as undirected graphs. This code seeks to find an alternative metric that is more suited for directed graphs so that these graphs can be better analyzed. In undirected graphs, this new metric is equal to the natural logarithm of the effective resistance divided by the commute time. This new metric has applications in graph symmetrization, clustering, structure detection, data exploration, and geometric detection. 
## Description of Files: 
### Hitting Probability Metric on Directed Graphs includes 3 distinct functions with two examples.
1.[Hitting_Times.py](https://github.com/mgvinal/Hitting-Probability-Metric-on-Directed-Graphs/blob/main/Hitting_Times.py): returns a matrix of probabilities of leaving one node (i) and then hitting another node (j) before returning to the original node (i). It requires an input of a stochastic matrix. 
2. [get_Ahp.py](C:\Users\Maddy\Desktop\Research Project\get_Ahp.py): returns the invariant measure matrix of the matrix of probabilities found in HittingTimes_L3(M). This symmetric adjacency matrix is our new distance metric for directed graphs. 
3. [ext_eff_res.py](C:\Users\Maddy\Desktop\Research Project\ext_eff_res.py): finds the extended effective resistance, as defined in ["Starling Flock Networks Manage Uncertainty in Consensus at Low Cost,"](https://pubmed.ncbi.nlm.nih.gov/23382667/) written by Young, Scardovi, Cavagna, Giardina, and Leonard (2013). The input (A) must be the probability transition matrix for a directed or undirected graph. While the output of this function itself (R) is not a metric, R^0.5 is a well-defined metric that we will use in comparison to our new metrics. The accompanying code to this project was originally in MATLAB, so I translated this code to python as well. 
4. [undirected_tree.py](C:\Users\Maddy\Desktop\Research Project\undirected_tree.py): contains an example of a standard undirected tree graph. The extended effective resistance and hitting probabilities when beta=1 and 0.5 matrices are all computed and visualized via heatmaps. Additionally, a graph visualization of this tree is also generated. 
5. [two_directed_cycles.py]("C:\Users\Maddy\Desktop\Research Project\two_directed_cycles.py"): contains the example used in the original paper. This graph is directed and consists of two directed 60-node-length cycles, connected along 5 common nodes. This example also undergoes calculations of its extended effective resistance and hitting probabilities when beta=1 and 0.5 matrices. All of these matrices are visualized using a heatmap, and a graph visualization is also provided. 
### Included Figures:
1. [2_cycles.png](C:\Users\Maddy\Desktop\Research Project\2_cycles.png): is the graph visualization for the two directed cycles. 
2. [tree.png](C:\Users\Maddy\Desktop\Research Project\tree.png): is the graph visualization for the tree. 
3. [d12_hm.png](C:\Users\Maddy\Desktop\Research Project\d12_hm.png): shows the heatmap for the hitting probabilities when beta=0.5 for the two directed cycles graph. 
4. [d1_hm.png](C:\Users\Maddy\Desktop\Research Project\d1_hm.png): shows the heatmap for the hitting probabilities when beta=1 for the two directed cycles graph. 
5. [d12t_hm.png](C:\Users\Maddy\Desktop\Research Project\d12t_hm.png): shows the heatmap for the hitting probabilities when beta=0.5 for the tree graph. 
6. [d1t_hm.png](C:\Users\Maddy\Desktop\Research Project\d1t_hm.png): shows the heatmap for the hitting probabilities when beta=1 for the tree graph. 
7. [exteffres2cyc.png](C:\Users\Maddy\Desktop\Research Project\exteffres2cyc.png): shows the heatmap for the extended effective resistance of the two directed cycles graph. 
8. [exteffrestree.png](C:\Users\Maddy\Desktop\Research Project\exteffrestree.png): shows the heatmap for the extended effective resistance of the tree graph. 
