# Hitting-Probability-Metric-on-Directed-Graphs
This code is the Python adaptation of the MATLAB code found in the paper "A Metric on Directed Graphs and Markov Chains Based on Hitting Probabilities," by Boyd, Fraiman, Marzuola, Mucha, Osting, and Weare. In the past, shortest path and effective resistance graph metrics have been naively applied to directed graphs in the same way as undirected graphs. This code seeks to find an alternative metric that is more suited for directed graphs so that these graphs can be better analyzed. In undirected graphs, this new metric is equal to the natural logarithm of the effective resistance divided by the commute time. This new metric has applications in graph symmetrization, clustering, structure detection, data exploration, and geometric detection. 
# Description of Files: 
Hitting Probability Metric on Directed Graphs includes 3 distinct functions with two examples.
1. HittingTimes_L3(M): returns a matrix of probabilities of leaving one node (i) and then hitting another node (j) before returning to the original node (i). It requires an input of a stochastic matrix. 
2. get_Ahp(P, beta=0.5): returns the invariant measure matrix of the matrix of probabilities found in HittingTimes_L3(M). This symmetric adjacency matrix is our new distance metric for directed graphs. 
3. extEffRes(A): finds the extended effective resistance, as defined in "Starling Flock Networks Manage Uncertainty in Consensus at Low Cost," written by Young, Scardovi, Cavagna, Giardina, and Leonard (2013). The input (A) must be the probability transition matrix for a directed or undirected graph. While the output of this function itself (R) is not a metric, R^0.5 is a well-defined metric that we will use in comparison to our new metrics. 
4. examples: contains two examples: one initially found in the original paper and MATLAB code, and an undirected geometric set. In the original paper, a graph was created containing two cycles glued along a path. For this graph, I computed the extended effective resistance as well as the Hitting Probabilities matrix when beta=0.5 and 1. I also visualized the graph using igraph. For the other example, I took a standard geometric set from igraph known as a tree, made it a similar size to the other example, and computed the same metrics. I visualized this graph as well.  
